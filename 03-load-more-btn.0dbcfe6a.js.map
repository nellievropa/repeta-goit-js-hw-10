{"mappings":"AAAA,MAEMA,EAAU,CACZC,QAAS,CACLC,cAJQ,qCCMhB,MAAMC,EAAO,CACTC,WAAYC,SAASC,cAAc,mBACnCC,kBAAmBF,SAASC,cAAc,gBAC1CE,YAAaH,SAASC,cAAc,8BAGlCG,EAAiB,IDJR,MACXC,cACJC,KAAKC,YAAc,GACnBD,KAAKE,KAAO,C,CAGgEC,gBAGvD,MAAHC,EAAM,uCAA4BJ,KAAKC,2CAA2CD,KAAKE,OAIS,OAAnGG,MAAMD,EAAKf,GACbiB,MAAKC,GAAYA,EAASC,SAC1BF,MAAK,EAACG,SAACA,MAGgBT,KAAfU,gBACLC,QAAQC,IAAI,kBAA+BZ,MAEpCS,I,CAMmBC,gBACtCV,KAAKE,MAAQ,C,CAGiEW,YAC9Eb,KAAKE,KAAO,C,CAKRY,YACA,OAAOd,KAAKC,W,CAGZa,UAAMC,GACNf,KAAKC,YAAcc,C,GCpCrBC,EAAetB,SAASC,cAAc,aA2EZ,SAAvBsB,EAAqBR,GAE1B,MAAMS,EAAST,EACdU,KAAI,EAACC,WAAEA,EAAUC,MAAEA,EAAKC,OAAEA,EAAMC,YAAEA,KAC1B,yBACKH,qCACNC,+BACUC,mBACXC,0BAINC,KAAK,IACNR,EAAaS,UAAYP,C,CAvF7BP,QAAQC,IAAId,GAEZN,EAAKC,WAAWiC,iBAAiB,UAMJ,SAAXC,GAgBgB,GAdSA,EAArCC,iBAQN9B,EAAegB,MAAQa,EAAEE,cAAcC,SAAShB,MAAMiB,MAM1B,KAAzBjC,EAAegB,MACd,OAAOkB,MAAM,2BAG4ClC,EAA9Ce,YAkBDf,EAAKK,gBAAgBG,MAAKG,IA+CpCjB,EAAKI,kBAAkB6B,UAAY,GA7C/BR,EAAqBR,EAAS,G,IA7CtCjB,EAAKK,YAAY6B,iBAAiB,SAoDqE,WAcrE5B,EAAfK,gBAAgBG,KAAKW,E","sources":["src/js/news-components.js","src/js/03-load-more-btn.js"],"sourcesContent":["const API_KEY = '15038c1cf1024f0f88ddd0a11fc0f440';\nconst BASE_URL = 'https://newsapi.org/v2';\nconst options = {\n    headers: {\n        Authorization: API_KEY,\n    },\n    };\n    // відповідає за збереження терміну запросу і номер групи(бо на сторінці ми отримаємо групу даних) \nexport default class NewsApiService {\n    constructor() {\nthis.searchQuery = '';\nthis.page = 1;\n    }\n// метод просто забираає статті з бекенду і повертає статті, що він забрав, у зовнішній код\n    fetchArticles() {\n        // console.log('До запросу: ', this);\n   \n            const url = `${BASE_URL}/everything?q=${this.searchQuery}&language=en&pageSize=8&page=${this.page}`;\n            \n          // робимо запит, і якщо він вдалий, то збільшуємо сторінку на 1(якщо не вдалий нам це не треба)\n        //   щоб мати можливість створити зовнішній вигляд статті у зовнішньому коді, нам  потрібно повернути цей fetch у зовнішній код командою return\n        return fetch(url, options)\n            .then(response => response.json())\n            .then(({articles}) => {\n                // console.log(data);\n                // this.page += 1; винесли у зовнішній код\n                this.incrementPage();\n                console.log('Після запросу: ', this);\n\n                return articles;\n            });\n    }\n\n// можна винестиу зовнішній код додавання сторінки \n\nincrementPage() {\n    this.page += 1;\n}\n// сторінка повинна оновлюватись при новому запиті і починати шукати з 1-ї сторінки знову, тому робимо reset()\nresetPage() {\n    this.page = 1;\n}\n\n// контролює термін запроса: отримати і зберегти\n    // збережемо нашу змінну класу searchQuery\n    get query() {\n        return this.searchQuery;\n    }\n\n    set query(newQuery) {\n        this.searchQuery = newQuery;\n    }\n}","// import articlesTpl from '../templates/articles.hbs'\nimport '../css/common.css';\nimport NewsApiService from './news-components';\n\n\n\nconst refs = {\n    searchForm: document.querySelector('.js-search-form'),\n    articlesContainer: document.querySelector('.js-articles'),\n    loadMoreBtn: document.querySelector('[data-action=\"load more\"]')\n};\n// створюємо екземпляр классу NewsApiService\nconst newsApiService = new NewsApiService();\n\nconst articlesList = document.querySelector(\".articles\");\nconsole.log(newsApiService);\n\nrefs.searchForm.addEventListener('submit', onSearch);\nrefs.loadMoreBtn.addEventListener('click', onLoadMore);\n// щоб прибрати цю глобальну змінну ми в класі NewsApiService створимо її заміну this.searchQuery = ''; і там же будемо її запам'ятовувати\n// let searchQuery ='';\n// і тоді ми можемо її прибрати звідси\n\nfunction onSearch(e) {\n    // щоб не перезавантажувалась сторінка робимоа preventDefault\n    e.preventDefault();\n\n// очищуємо сторінку перед новим запитом\n// clearArticlesContainer();\n\n// отримуєм доступ до форми, щоб читати запити\n// тут достукуємось також до цієї змінної\n//  searchQuery = e.currentTarget.elements.query.value\nnewsApiService.query = e.currentTarget.elements.query.value;\n\n// без GET i SET верхній запис буде виглядати так \n// newsApiService.searchQuery = e.currentTarget.elements.query.value; тоді треба замінити на searchQuery всюди\n\n// напишемо попередження про пусту строку\nif(newsApiService.query === '') {\n    return alert(`Please, make a request!`)\n}\n// під час сабміту сторінка буде онвлюватись до 1-ї, коли ми пишемо новий запит\nnewsApiService.resetPage();\n// При сабміті форми треба викликати сторінку на  newsapi.org\n    // const options = {\n    //     headers: {\n    //         Authorization: '15038c1cf1024f0f88ddd0a11fc0f440',\n    //     },\n    //     };\n        \n    //     const url = `https://newsapi.org/v2/everything?q=${searchQuery}&language=en&pageSize=8&page=1`;\n        \n        \n    //     fetch(url, options)\n    //     .then(r => r.json)\n    //     .then(console.log());\n    // всю цю логіку виносимо в окремий спеціально створений файл news-components\n    // і після того, як ми створили екземпляр классу NewsApiService і викликали його вище, звертаємось до нього\n    // а  searchQuery  передаємо йому як аргумент\n// тут додаємо articles\n    newsApiService.fetchArticles().then(articles => {\n        clearArticlesContainer();\n        appendArticlesMarkup(articles)\n    });\n}\n\n// ми хочемо підгружати наступні сторінки при натисканні кнопки \"Показати ще\"\n// робим те саме, АЛЕ маємо проблему як достукатися до змінної const searchQuery ,якщо вона існує тільки в попередній функції?\n// тобто під час сабміту (натискання кнопки \"Пошук\") ми повинні зберігати десь ці данні, щоб потім їх взяти звідти! використовуємо LET\nfunction onLoadMore() {\n    // const options = {\n    //     headers: {\n    //         Authorization: '15038c1cf1024f0f88ddd0a11fc0f440',\n    //     },\n    //     };\n        \n    //     const url = `https://newsapi.org/v2/everything?q=${searchQuery}&language=en&pageSize=8&page=1`;\n        \n        \n    //     fetch(url, options)\n    //     .then(r => r.json)\n    //     .then(console.log());\n    // в цій функції все робимо аналогічно\n    newsApiService.fetchArticles().then(appendArticlesMarkup);\n}\n\n// що створити розмітку зробимо функцію\n\nfunction appendArticlesMarkup(articles) {\n    // refs.articlesContainer.insertAdjacentHTML('beforeend', articlesTpl(articles));\n    const markup = articles\n    .map(({ urlToImage, title, author, description }) => {\n      return `<li>\n      <img src=\"${urlToImage}\" alt=\"\" width=\"480\">\n      <h2>${title}</h2>\n      <p>Posted by: ${author}</p>\n      <p>${description}</p>\n\n       </li>`;\n    })\n    .join(\"\");\n    articlesList.innerHTML = markup;\n}\n\n// при кожному новому запиті треба очищати контайнер, щоб виводилось не в кінці попереднього запиту, а зверху і знову\n\nfunction clearArticlesContainer() {\n    refs.articlesContainer.innerHTML = '';\n}\n\n\n\n\n"],"names":["$234681ecda4a62b0$var$options","headers","Authorization","$dbfbdf498c2a314a$var$refs","searchForm","document","querySelector","articlesContainer","loadMoreBtn","$dbfbdf498c2a314a$var$newsApiService","constructor","this","searchQuery","page","fetchArticles","url","fetch","then","response","json","articles","incrementPage","console","log","resetPage","query","newQuery","$dbfbdf498c2a314a$var$articlesList","$dbfbdf498c2a314a$var$appendArticlesMarkup","markup","map","urlToImage","title","author","description","join","innerHTML","addEventListener","e","preventDefault","currentTarget","elements","value","alert"],"version":3,"file":"03-load-more-btn.0dbcfe6a.js.map"}